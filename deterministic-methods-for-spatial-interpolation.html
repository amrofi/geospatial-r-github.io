<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>deterministic-methods-for-spatial-interpolation.utf8</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Geospatial Data Science in R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="getting-started-with-r.html">Getting Started with R</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Data Processing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">Content</a>
    </li>
    <li>
      <a href="read-write-spatial-data.html">Read and Write Spatial Data</a>
    </li>
    <li>
      <a href="map-projection-coordinate-reference-systems.html">Map Projection and Coordinate Reference Systems</a>
    </li>
    <li>
      <a href="geoprocessing-vector-data.html">Geoprocessing of Vector data</a>
    </li>
    <li>
      <a href="working-with-spatial-point-data.html">Working with Spatial Point Data</a>
    </li>
    <li>
      <a href="working-with-spatial-polygon.html">Working with Spatial Polygon Data</a>
    </li>
    <li>
      <a href="working-with-raster-data.html">Working with Raster Data</a>
    </li>
    <li>
      <a href="netCDF-data-processing.html">netCDF Data Processing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about-b.html">Content</a>
    </li>
    <li>
      <a href="spatial-autocorrelation.html">Spatial Autocorrelation</a>
    </li>
    <li>
      <a href="point-pattern-analysis.html">Point Pattern Analysis</a>
    </li>
    <li>
      <a href="geographically-weighted-models.html">Geographically Weighted Model</a>
    </li>
    <li>
      <a href="geographically-weighted-summary-statistics.html">Geographically Weighted Summary Statistics</a>
    </li>
    <li>
      <a href="geographically-weighted-principal-components-analysis.html">Geographically Weighted Principal Components Analysis</a>
    </li>
    <li>
      <a href="geographically-weighted-regression.html">Geographically Weighted Regression</a>
    </li>
    <li>
      <a href="geographically-weighted-ols-regression.html">Geographically Weighted OLS Regression</a>
    </li>
    <li>
      <a href="geographically-weighted-poisson-regression.html">Geographically Weighted Poisson Regression</a>
    </li>
    <li>
      <a href="geographically-wighted-random-forest.html">Global and Local (geographically weighted) Random Forest</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Spatial Interpolation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about-d.html">Content</a>
    </li>
    <li>
      <a href="deterministic-methods-for-spatial-interpolation.html">Deterministic Methods for Spatial Interpolation</a>
    </li>
    <li>
      <a href="geostatistical-methods-for-spatial-interpolation.html">Geostatistical Methods for Spatial Interpolation</a>
    </li>
    <li>
      <a href="semivariogram-modeling.html">Semivariogram Modeling</a>
    </li>
    <li>
      <a href="kriging.html">Kriging</a>
    </li>
    <li>
      <a href="ordinary-kriging.html">Ordinary Kriging</a>
    </li>
    <li>
      <a href="universal-kriging.html">Universal Kriging</a>
    </li>
    <li>
      <a href="cokriging.html">Co-Kriging</a>
    </li>
    <li>
      <a href="regression-kriging.html">Regression kriging</a>
    </li>
    <li>
      <a href="indicator-kriging.html">Indicator kriging</a>
    </li>
    <li>
      <a href="assessing-quality-spatial-predictions.html">Assessing the Quality of Spatial Predictions</a>
    </li>
    <li>
      <a href="cross-validation.html">Cross-validation</a>
    </li>
    <li>
      <a href="validation-independent-dataset.html">Validation with an Independent Dataset</a>
    </li>
    <li>
      <a href="conditional-simulation-spatial-uncertainty.html">Conditional Simulation for Spatial Uncertainty</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Remote Sensing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about-c.html">Content</a>
    </li>
    <li>
      <a href="reomte-sensing-basic.html">Remote Sensing Basic</a>
    </li>
    <li>
      <a href="landsat-8-image-processing.html">Landsat 8 Image Processing &amp; Visualization</a>
    </li>
    <li>
      <a href="spectral-indices.html">Spectral Indices</a>
    </li>
    <li>
      <a href="uav-ground-cover.html">Green Ground Cover from UAV Images</a>
    </li>
    <li>
      <a href="texture-analysis.html">Texture Analysis</a>
    </li>
    <li>
      <a href="image-classification.html">Image Classification</a>
    </li>
    <li>
      <a href="ground-truth-data-processing.html">Ground Truth Data Processing</a>
    </li>
    <li>
      <a href="unsupervised-classification.html">Unsupervised Classification</a>
    </li>
    <li>
      <a href="supervised-classification.html">Supervised Classification</a>
    </li>
    <li>
      <a href="random-forest.html">Random Forest</a>
    </li>
    <li>
      <a href="support-vector-machine.html">Support Vector Machine</a>
    </li>
    <li>
      <a href="naive-bayes.html">Naïve Bayes</a>
    </li>
    <li>
      <a href="exboost.html">eXtreme Gradient Boosting</a>
    </li>
    <li>
      <a href="deep-learning-h2o.html">Deep Learning with H20</a>
    </li>
    <li>
      <a href="stack-ensemble-h2o.html">Stack-Ensemble-H20</a>
    </li>
    <li>
      <a href="deep-learning-keras-tensorflow.html">Deep Learning with Keras-TensorFlow</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:zia207@gmail.com">
    <span class="fa fa-envelope fa-lg"></span>
     
    Email
  </a>
</li>
<li>
  <a href="http://github.com/zia207">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/zia-ahmed-a7653578">
    <span class="fa fa-linkedin fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<img src="Image/empty_banner.png" width="100%" style="display: block; margin: auto;" />
<div style="margin-bottom:20px;">

</div>
<div id="deterministic-methods-for-spatial-interpolation" class="section level1">
<h1>Deterministic Methods for Spatial Interpolation</h1>
<div style="margin-bottom:20px;">

</div>
<p>Deterministic interpolation techniques, also known as exact interpolator, predict values from measured points, based on either the extent of similarity (inverse distance weighted) or the degree of smoothing (radial basis functions). This kind of interpolation techniques usually predict a value that is identical to the measured value at a sampled location without documenting potential error or error is assumed to be negligible.</p>
<p>Global techniques calculate predictions using the entire data set (Polynomial Trend Surface). Local techniques calculate predictions from the measured points within neighborhoods, which are smaller spatial areas within the larger study area.</p>
<p>In this exercise we will explore following deterministic methods to predict Soil Organic C:</p>
<ul>
<li><p><a href="#polynomial-trend-surface">Polynomial Trend Surface</a></p></li>
<li><p><a href="#proximity-analysis-thiessen-polygons">Proximity Analysis-Thiessen Polygons</a></p></li>
<li><p><a href="#nearest-neighbor-interpolation">Nearest Neighbor Interpolation</a></p></li>
<li><p><a href="#inverse-distance-weighted-interpolation">Inverse Distance Weighted</a></p></li>
<li><p><a href="#thin-plate-spline">Thin Plate Spline</a></p></li>
</ul>
<div style="margin-bottom:20px;">

</div>
<div id="load-package" class="section level4">
<h4>Load package:</h4>
<pre class="r"><code>library(plyr)
library(dplyr)
library(gstat)
library(raster)
library(ggplot2)
library(car)
library(classInt)
library(RStoolbox)
library(spatstat)
library(dismo)
library(fields)</code></pre>
</div>
<div id="load-data" class="section level4">
<h4>Load Data</h4>
<p>The soil organic carbon data (train and test data set) could be found <a href="https://www.dropbox.com/s/d6nnlu2da93mp48/DATA_08.7z?dl=0">here</a>.</p>
<pre class="r"><code># Define data folder
dataFolder&lt;-&quot;D:\\Dropbox\\Spatial Data Analysis and Processing in R\\DATA_08\\DATA_08\\&quot;</code></pre>
<pre class="r"><code>train&lt;-read.csv(paste0(dataFolder,&quot;train_data.csv&quot;), header= TRUE) 
state&lt;-shapefile(paste0(dataFolder,&quot;GP_STATE.shp&quot;))
grid&lt;-read.csv(paste0(dataFolder, &quot;GP_prediction_grid_data.csv&quot;), header= TRUE) </code></pre>
<pre class="r"><code>p.grid&lt;-grid[,2:3]</code></pre>
</div>
<div id="define-coordinates" class="section level4">
<h4>Define coordinates</h4>
<pre class="r"><code>coordinates(train) = ~x+y
coordinates(grid) = ~x+y
gridded(grid) &lt;- TRUE </code></pre>
</div>
<div id="polynomial-trend-surface" class="section level3">
<h3>Polynomial Trend Surface</h3>
<p>Polynomial trend surfaces analysis is the most widely used global interpolation techniques where data is fitted with a least square equation (linear or quadratic equation), and then, interpolate surface is created based on this equation. The nature of the resulting surface is controlled by the order of the polynomial.</p>
<div id="linear-fit" class="section level4">
<h4>Linear fit</h4>
<p>To fit a first order polynomial model:<br />
SOC =intercept + aX+ bY (X = x coordinates, Y= y- coordinates)</p>
<p>We will use <strong>krige()</strong> function of gstat <strong>package</strong> without the geographic coordinates specified. It will perform <strong>ordinary or weighted least squares prediction</strong></p>
<pre class="r"><code>model.lm&lt;-krige(SOC ~ x + y, train, grid)</code></pre>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<pre class="r"><code>summary(model.lm)</code></pre>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min     max
## x -1250285  119715
## y   998795 2538795
## Is projected: NA 
## proj4string : [NA]
## Number of points: 10674
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          -1245285    10000       137
## y           1003795    10000       154
## Data attributes:
##    var1.pred        var1.var    
##  Min.   :2.726   Min.   :23.89  
##  1st Qu.:5.046   1st Qu.:23.94  
##  Median :6.480   Median :24.00  
##  Mean   :6.190   Mean   :24.03  
##  3rd Qu.:7.254   3rd Qu.:24.10  
##  Max.   :9.006   Max.   :24.39</code></pre>
<div id="plot-map" class="section level5">
<h5>Plot map</h5>
<pre class="r"><code>spplot(model.lm ,&quot;var1.pred&quot;,
       main= &quot;1st Order Trend Surface&quot;)</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-8-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="quadratic-fit" class="section level4">
<h4>Quadratic Fit</h4>
<p>To fit a second order polynomial model:</p>
<p>SOC = x + y + I(x*y) + I(x^2) + I(y^2)</p>
<pre class="r"><code>model.quad&lt;-krige(SOC ~ x + y + I(x*y) + I(x^2) + I(y^2), train, grid)</code></pre>
<pre><code>## [ordinary or weighted least squares prediction]</code></pre>
<pre class="r"><code>summary(model.quad)</code></pre>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min     max
## x -1250285  119715
## y   998795 2538795
## Is projected: NA 
## proj4string : [NA]
## Number of points: 10674
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          -1245285    10000       137
## y           1003795    10000       154
## Data attributes:
##    var1.pred          var1.var    
##  Min.   : 0.6923   Min.   :21.84  
##  1st Qu.: 5.0919   1st Qu.:21.88  
##  Median : 6.0541   Median :21.96  
##  Mean   : 6.1666   Mean   :22.06  
##  3rd Qu.: 7.5374   3rd Qu.:22.17  
##  Max.   :11.5427   Max.   :23.52</code></pre>
<div id="plot-map-1" class="section level5">
<h5>Plot map</h5>
<pre class="r"><code>spplot(model.quad ,&quot;var1.pred&quot;,
       main= &quot;2nd Order Trend Surface&quot;)</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-10-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="proximity-analysis-thiessen-polygons" class="section level3">
<h3>Proximity Analysis-Thiessen Polygons</h3>
<p>Thiessen polygons is the simplest interpolation method by which we can assign values at all unsampled locations considering the value of the closest sampled location. This way we can define boundaries of an area that is closest to each point relative to all other points. <a href="https://www.ian-ko.com/ET_GeoWizards/UserGuide/thiessenPolygons.htm">They are mathematically defined by the perpendicular bisectors of the lines between all points</a>.</p>
<p>The Thiessen polygons can be created using ’s *<strong>dirichlet()</strong> function of <strong>spatstat</strong> or <strong>voronoi()</strong> function of <strong>dismo</strong> package in R</p>
<p>Here, we will apply <strong>voronoi</strong> function of <strong>dismo</strong> package</p>
<p>Before creating thiessen polygons, we have to create a <strong>SpatialPointsDataFrame</strong></p>
<pre class="r"><code>df&lt;-as.data.frame(train)
##  define coordinates
xy &lt;- df[,8:9]
SOC&lt;-as.data.frame(df[,10])
names(SOC)[1]&lt;-&quot;SOC&quot;
# Convert to spatial point
SPDF &lt;- SpatialPointsDataFrame(coords = xy, data=SOC) </code></pre>
<pre class="r"><code>v &lt;- voronoi(SPDF)
plot(v)</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-12-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Plot looks not good, lets confined into GP state boundary.</p>
<pre class="r"><code># disslove inter-state boundary
bd &lt;- aggregate(state)
# apply intersect fuction to clip
v.gp &lt;- raster::intersect(v, bd)</code></pre>
<pre><code>## Warning in raster::intersect(v, bd): non identical CRS</code></pre>
<p>Now we plot the maps</p>
<pre class="r"><code>spplot(v.gp, &#39;SOC&#39;,
       main= &quot;Thiessen polygons (Voronoi)&quot;,
       col.regions=rev(get_col_regions()))</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-14-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Now will convert this Voronoi polygon to raster (10 km x 10 km)</p>
<pre class="r"><code>r &lt;- raster(bd, res=10000)
vr &lt;- rasterize(v.gp, r, &#39;SOC&#39;)</code></pre>
<div id="plot-map-2" class="section level4">
<h4>Plot map</h4>
<pre class="r"><code>ggR(vr, geom_raster = TRUE) +
  scale_fill_gradientn(&quot;SOC&quot;, colours = c(&quot;orange&quot;, &quot;yellow&quot;, &quot;green&quot;,  &quot;blue&quot;,&quot;sky blue&quot;))+
  theme_bw()+
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
   ggtitle(&quot;Thiessen polygons (Voronoi) of SOC&quot;)+
   theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-16-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="nearest-neighbor-interpolation" class="section level3">
<h3>Nearest Neighbor Interpolation</h3>
<p>Here we do nearest neighbor interpolation considering multiple (5) neighbors.</p>
<p>We will use the <strong>gstat</strong> package to interpolate SOC using Nearest Neighbor Interpolation. First we fit a model ( ~1 means) “intercept only” using krige() function. In the case of spatial data, that would be only ‘x’ and ‘y’ coordinates are used. We set the maximum number of points to 5, and the “inverse distance power” idp to zero, such that all five neighbors are equally weighted.</p>
<pre class="r"><code>nn &lt;- krige(SOC ~ 1, train, grid, nmax=5, set=list(idp = 0))</code></pre>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<div id="convert-to-raster" class="section level4">
<h4>Convert to raster</h4>
<pre class="r"><code>nn.na&lt;-na.omit(nn)
nn.pred&lt;-rasterFromXYZ(as.data.frame(nn)[, c(&quot;x&quot;, &quot;y&quot;, &quot;var1.pred&quot;)])</code></pre>
</div>
<div id="plot-nearest-neighbour-predicted-soc" class="section level4">
<h4>Plot Nearest Neighbour predicted SOC</h4>
<pre class="r"><code>ggR(nn.pred, geom_raster = TRUE) +
  scale_fill_gradientn(&quot;SOC&quot;, colours = c(&quot;orange&quot;, &quot;yellow&quot;, &quot;green&quot;,  &quot;sky blue&quot;,&quot;blue&quot;))+
  theme_bw()+
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
   ggtitle(&quot;Nearest Neighbour\n Predicted SOC&quot;)+
   theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-19-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="inverse-distance-weighted-interpolation" class="section level3">
<h3>Inverse Distance Weighted Interpolation</h3>
<p><strong>Inverse distance weighted (IDW)</strong> is one of the most commonly used <strong>non-statistical</strong> method for spatial interpolation based on an assumption that things that are close to one another are more alike than those that are farther apart, and each measured point has a local influence that diminishes with distance. It gives greater weights to points closest to the prediction location, and the weights diminish as a function of distance. The factors that affect the accuracy of IWD are the value of the power parameter and size and the number of the neighbor.</p>
<p><img src="Image/PNG_FILE_07/IDW.png" width="40%" style="display: block; margin: auto;" /></p>
<p>We will use the <strong>gstat</strong> package to interpolate SOC using IDW. First we fit a model ( ~1 means) “intercept only” using krige() function. In the case of spatial data, that would be only ‘x’ and ‘y’ coordinates are used.</p>
<pre class="r"><code>IDW&lt;- krige(SOC ~ 1, train, grid)</code></pre>
<pre><code>## [inverse distance weighted interpolation]</code></pre>
<pre class="r"><code>summary(IDW)</code></pre>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min     max
## x -1250285  119715
## y   998795 2538795
## Is projected: NA 
## proj4string : [NA]
## Number of points: 10674
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          -1245285    10000       137
## y           1003795    10000       154
## Data attributes:
##    var1.pred          var1.var    
##  Min.   : 0.4831   Min.   : NA    
##  1st Qu.: 4.2517   1st Qu.: NA    
##  Median : 5.7212   Median : NA    
##  Mean   : 6.1423   Mean   :NaN    
##  3rd Qu.: 7.6260   3rd Qu.: NA    
##  Max.   :29.0807   Max.   : NA    
##                    NA&#39;s   :10674</code></pre>
<div id="convert-to-raster-1" class="section level4">
<h4>Convert to raster</h4>
<pre class="r"><code>idw.na&lt;-na.omit(idw)
IDW.pred&lt;-rasterFromXYZ(as.data.frame(IDW)[, c(&quot;x&quot;, &quot;y&quot;, &quot;var1.pred&quot;)])</code></pre>
</div>
<div id="plot-idw-predicted-soc" class="section level4">
<h4>Plot IDW predicted SOC</h4>
<pre class="r"><code>ggR(IDW.pred, geom_raster = TRUE) +
  scale_fill_gradientn(&quot;SOC&quot;, colours = c(&quot;orange&quot;, &quot;yellow&quot;, &quot;green&quot;,  &quot;sky blue&quot;,&quot;blue&quot;))+
  theme_bw()+
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
   ggtitle(&quot;Inverse Distance Weighted (IDW)\n Predicted SOC&quot;)+
   theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-23-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="thin-plate-spline" class="section level3">
<h3>Thin Plate Spline</h3>
<p>Thin Plate Splines are used to produce approximations to given data in more than one dimension. These are analogous to the cubic splines in one dimension. We can fits a thin plate spline surface to irregularly spaced spatial data.</p>
<p>We use <strong>Tps()</strong> function of <strong>field</strong> package to create thin plate spline surface</p>
<pre class="r"><code>m &lt;- Tps(coordinates(train), train$SOC)
tps &lt;- interpolate(r, m)  
plot(tps)</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-24-1.png" width="432" style="display: block; margin: auto;" /></p>
<pre class="r"><code>tps &lt;- raster::mask(tps,bd) # mask out </code></pre>
<pre class="r"><code>ggR(tps, geom_raster = TRUE) +
  scale_fill_gradientn(&quot;SOC&quot;, colours = c(&quot;orange&quot;, &quot;yellow&quot;, &quot;green&quot;,  &quot;sky blue&quot;,&quot;blue&quot;))+
  theme_bw()+
    theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank(),
        axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
   ggtitle(&quot;Thin Plate Spline\n Predicted SOC&quot;)+
   theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="deterministic-methods-for-spatial-interpolation_files/figure-html/unnamed-chunk-25-1.png" width="432" style="display: block; margin: auto;" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
